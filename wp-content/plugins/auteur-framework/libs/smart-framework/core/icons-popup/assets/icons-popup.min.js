var GSF_ICON_POPUP=GSF_ICON_POPUP||{};(function(a){'use strict';GSF_ICON_POPUP={_$popup:[],_callback:function(){},_currentFontId:0,_timeOutSearch:null,init:function(){var b=this;b._$popup=a('#gsf-popup-icon-wrapper'),0===b._$popup.length&&a.ajax({url:GSF_POPUP_DATA.ajaxUrl,type:'post',data:{action:'gsf_get_font_icons',nonce:GSF_POPUP_DATA.nonce},success:function(c){var f,g,h,i,j,k,d=JSON.parse(c),e=wp.template('gsf-icons-popup');if(0!=a('#tmpl-gsf-icons-popup').length){for(f in d)for(0===b._currentFontId&&(b._currentFontId=f),d[f].icons=[],h=d[f].iconGroup.length,g=0;g<h;g++)for(j=d[f].iconGroup[g].icons.length,i=0;i<j;i++)k=d[f].iconGroup[g].icons[i],k in d[f].icons?d[f].icons[k]+=d[f].iconGroup[g].id+'|':d[f].icons[k]='|'+d[f].iconGroup[g].id+'|';var l=e(d);a('body').append(l),b._$popup=a('#gsf-popup-icon-wrapper'),b.settingPopup(),b.popupListener()}}})},settingPopup:function(){var b=this._$popup.find('.gsf-popup-icon-font-link-inner'),c=b.find('.gsf-popup-icon-group-link'),d=this._$popup.find('.gsf-popup-icon-group-section'),e=this._$popup.find('.gsf-popup-icon-listing');b.perfectScrollbar({wheelSpeed:0.5,suppressScrollX:!0}),e.perfectScrollbar({wheelSpeed:0.5,suppressScrollX:!0}),c.css('display','none'),c.first().css('display','block'),d.css('display','none'),d.first().css('display','block')},popupListener:function(){var b=this,c=b._$popup.find('.gsf-popup-icon-search > input'),d=b._$popup.find('.gsf-popup-icon-group-link a'),e=b._$popup.find('.gsf-popup-icon-group-title'),f=b._$popup.find('.gsf-popup-icon-font > select');c.on('keyup',function(){clearTimeout(b._timeOutSearch),b._timeOutSearch=setTimeout(function(){var g=c.val(),h=b._$popup.find('.gsf-popup-icon-group-section[data-font-id="'+b._currentFontId+'"]'),i=h.find('li');''===g?e.text(e.data('msg-all')):e.text(e.data('msg-search').replace('{0}',g)),i.each(function(){var j=a(this);0>j.attr('title').search(new RegExp(g,'i'))?j.hide():j.show()}),b.updateListingScroll()},300)}),d.on('click',function(){var g=b._$popup.find('.gsf-popup-icon-group-section[data-font-id="'+b._currentFontId+'"]'),h=g.find('li'),i=a(this),j=i.data('id');e.text(i.text()),c.val(''),''===j?(g.find('.gsf-popup-icon-group-section').show(),h.show()):(h.hide(),h.each(function(){var k=a(this);-1<k.data('group').search(new RegExp('\\|'+j+'\\|','i'))?k.show():k.hide()})),b.updateListingScroll()}),this._$popup.find('.gsf-popup-icon-group-section i').on('click',function(){b._$popup.find('.mfp-close').trigger('click'),b._callback(a(this).attr('class'))}),f.on('change',function(){var g=b._$popup.find('.gsf-popup-icon-font-link-inner'),h=g.find('.gsf-popup-icon-group-link'),i=b._$popup.find('.gsf-popup-icon-group-section'),j=b._$popup.find('.gsf-popup-icon-search > input');b._currentFontId=a(this).val(),h.fadeOut(),i.fadeOut(),h.each(function(){var k=a(this);if(k.data('font-id')===b._currentFontId)return void k.fadeIn(function(){b.updateLinkScroll()})}),i.each(function(){var k=a(this);if(k.data('font-id')===b._currentFontId)return void k.fadeIn(function(){b.updateListingScroll()})}),j.val(''),j.trigger('keyup')})},updateLinkScroll:function(){a('.gsf-popup-icon-font-link-inner').perfectScrollbar('update')},updateListingScroll:function(){a('.gsf-popup-icon-listing').perfectScrollbar('update')},open:function(b,c){var d=this,e=d._$popup.find('.gsf-popup-icon-search > input');e.val(''),e.trigger('keyup'),'function'==typeof c&&(d._callback=c),a.magnificPopup.open({items:{src:'#gsf-popup-icon-wrapper',type:'inline'},mainClass:'mfp-move-horizontal',callbacks:{open:function(){if(null!=b&&''!==b){var f=d._$popup.find('.gsf-popup-icon-group-section li[title="'+b+'"]');if(d._$popup.find('.gsf-popup-icon-group-section li').removeClass('active'),f.length){f.addClass('active');var g=f.closest('.gsf-popup-icon-group-section'),h=d._$popup.find('.gsf-popup-icon-font > select'),i=g.data('font-id');h.val(i),h.trigger('change'),a('.gsf-popup-icon-listing').scrollTop(f.position().top)}}d.updateLinkScroll(),d.updateListingScroll()}},openDelay:0,removalDelay:100,midClick:!0})},close:function(){}},a(document).ready(function(){GSF_ICON_POPUP.init()})})(jQuery);